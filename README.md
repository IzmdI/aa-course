# AA Course
Курс по асинхронной архитектуре

## Схемы
Доска MIRO тут [тыц](https://miro.com/app/board/uXjVMxFUl2Q=/).

### Обновления

* Для второй версии задач потребовалось разделить поле `title` на 2 поля - `title` и `jira_id`.
Для этого были сделаны следующие шаги:  

    1. Добавлено поле `jira_id` в таблицу Task в task-service. Поле должно быть Nullable как в таблице, так и в новой схеме, для сохранения обратной и прямой совместимости.
    2. Добавлено nullable поле `jira_id` в таблицы Task в других сервисах, где оно нужно. 
    3. Сделаны и залииты новые миграции в соответствующих сервисах.
    4. В Schema Registry добавлена вторая версия схемы `streaming` для задач.
    5. В консюмеры, которые работают с этой схемой, добавлен роутинг по версии, чтобы корректно обрабатывались предыдущая и новая версии.
    6. Продюсер `streaming` для задач был переведён на новую версию схемы.
    7. Бизнес-логика в сервисе задач была обновлена, чтобы поле `jira_id` заполнялось корректно.
    8. Спустя некоторое время, когда мы убедились, что все ивенты предыдущей версии были обработаны, из консюмеров убрали предыдущую версию схемы. Либо можно было написать и запустить новые консюмеры, работающие с новой версией схемы, а старые отключить. Можно и вовсе оставить роутинг по версии событий, включающий все версии.
